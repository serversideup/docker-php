name: Docker Publish (Beta Images)

on:
  push:
    branches:
      - main
  schedule:
    - cron: '0 8 * * 1'

jobs:
  cli:
    uses: ./.github/workflows/workflow-docker-publish.yml
    with:
      upstream-channel-prefix: "beta-"
      tag-prefix: "beta-"
      php-variation: cli
      checkout-type: branch
      checkout-reference: main
    secrets: inherit

  fpm:
    needs: cli
    uses: ./.github/workflows/workflow-docker-publish.yml
    with:
      upstream-channel-prefix: "beta-"
      tag-prefix: "beta-"
      php-variation: fpm
      checkout-type: branch
      checkout-reference: main
    secrets: inherit

  fpm-nginx:
    needs: fpm
    uses: ./.github/workflows/workflow-docker-publish.yml
    with:
      upstream-channel-prefix: "beta-"
      tag-prefix: "beta-"
      php-variation: fpm-nginx
      checkout-type: branch
      checkout-reference: main
    secrets: inherit

  fpm-apache:
    needs: fpm
    uses: ./.github/workflows/workflow-docker-publish.yml
    with:
      upstream-channel-prefix: "beta-"
      tag-prefix: "beta-"
      php-variation: fpm-apache
      checkout-type: branch
      checkout-reference: main
    secrets: inherit