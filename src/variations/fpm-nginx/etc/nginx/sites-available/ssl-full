# HTTP Redirect configuration
#
server {
	listen 8080 default_server;
	listen [::]:8080 default_server;

	server_name _;

	location /ping {
			if ($host = "localhost") {
					return 301 https://$host:8443$request_uri;
			}
	}

	location / {
			# Default redirect for all other cases
			return 301 https://$host$request_uri;
	}
}

# HTTPS configuration
#
server {
	include /etc/nginx/site-opts.d/https.conf;
}