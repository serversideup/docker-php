# HTTP Redirect configuration
#
server {
	listen 8080 default_server;
	listen [::]:8080 default_server;

	server_name _;

	# Exclude the /ping endpoint from redirection
	location /ping {
		access_log off;
		return 301 https://localhost:8443/ping;
	}

	# Redirect all other HTTP traffic to HTTPS
	location / {
		return 301 https://$host$request_uri;
	}

}

# HTTPS configuration
#
server {
	include /etc/nginx/site-opts.d/https.conf;
}